<div class="highlight"><pre><span class="cm">/* Every closure has a delegate property. </span>
<span class="cm">By default the delegate points to the object that the closure was invoked on.</span>
<span class="cm">*/</span>

<span class="n">Complex</span><span class="o">.</span><span class="na">metaClass</span><span class="o">.</span><span class="na">plus</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Complex</span> <span class="n">c</span> <span class="o">-&gt;</span> <span class="n">delegate</span><span class="o">.</span><span class="na">add</span> <span class="n">c</span> <span class="o">}</span>
<span class="n">Complex</span><span class="o">.</span><span class="na">metaClass</span><span class="o">.</span><span class="na">minus</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Complex</span> <span class="n">c</span> <span class="o">-&gt;</span> <span class="n">delegate</span><span class="o">.</span><span class="na">subtract</span> <span class="n">c</span> <span class="o">}</span>

<span class="kt">def</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Complex</span><span class="o">(</span><span class="nl">real:</span> <span class="mi">1</span><span class="o">,</span> <span class="nl">imaginary:</span> <span class="mi">2</span><span class="o">)</span>
<span class="kt">def</span> <span class="n">c2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Complex</span><span class="o">(</span><span class="nl">real:</span> <span class="mi">3</span><span class="o">,</span> <span class="nl">imaginary:</span> <span class="mi">4</span><span class="o">)</span>
<span class="kt">def</span> <span class="n">c3</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span>

<span class="n">println</span> <span class="n">c3</span> <span class="o">==</span> <span class="k">new</span> <span class="n">Complex</span><span class="o">(</span><span class="nl">real:</span> <span class="mi">4</span><span class="o">,</span> <span class="nl">imaginary:</span> <span class="mi">6</span><span class="o">)</span>

<span class="nd">@EqualsAndHashCode</span>
<span class="kd">class</span> <span class="nc">Complex</span><span class="o">{</span>
    <span class="kt">def</span> <span class="n">real</span><span class="o">,</span> <span class="n">imaginary</span>

    <span class="n">Complex</span> <span class="nf">add</span><span class="o">(</span><span class="n">Complex</span> <span class="n">c</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">real</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="na">real</span>
        <span class="k">this</span><span class="o">.</span><span class="na">imaginary</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="na">imaginary</span>
        <span class="k">this</span>
    <span class="o">}</span>

    <span class="n">Complex</span> <span class="nf">subtract</span><span class="o">(</span><span class="n">Complex</span> <span class="n">c</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">real</span> <span class="o">-=</span> <span class="n">c</span><span class="o">.</span><span class="na">real</span>
        <span class="k">this</span><span class="o">.</span><span class="na">imaginary</span> <span class="o">-=</span> <span class="n">c</span><span class="o">.</span><span class="na">imaginary</span>
        <span class="k">this</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s2">&quot;($real + ${imaginary}i)&quot;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>