<div class="highlight"><pre> <span class="kd">private</span> <span class="kt">void</span> <span class="nf">fileWatcherService</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span><span class="o">{</span>
   <span class="n">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;C:/temp&quot;</span><span class="o">);</span>
   <span class="n">WatchService</span> <span class="n">watchService</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">getFileSystem</span><span class="o">().</span><span class="na">newWatchService</span><span class="o">();</span>
   <span class="n">path</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">watchService</span><span class="o">,</span> <span class="n">StandardWatchEventKinds</span><span class="o">.</span><span class="na">ENTRY_MODIFY</span><span class="o">);</span> <span class="c1">//only event can be registered per watch service</span>

   <span class="k">for</span><span class="o">(;;){</span>
      <span class="kd">final</span> <span class="n">WatchKey</span> <span class="n">watchKey</span> <span class="o">=</span> <span class="n">watchService</span><span class="o">.</span><span class="na">take</span><span class="o">();</span>
      <span class="k">for</span> <span class="o">(</span><span class="n">WatchEvent</span><span class="o">&lt;?&gt;</span> <span class="n">watchEvent</span> <span class="o">:</span> <span class="n">watchKey</span><span class="o">.</span><span class="na">pollEvents</span><span class="o">())</span> <span class="o">{</span>
         <span class="kd">final</span> <span class="n">Path</span> <span class="n">context</span> <span class="o">=</span> <span class="o">(</span><span class="n">Path</span><span class="o">)</span> <span class="n">watchEvent</span><span class="o">.</span><span class="na">context</span><span class="o">();</span>
         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Event kind: &quot;</span> <span class="o">+</span> <span class="n">watchEvent</span><span class="o">.</span><span class="na">kind</span><span class="o">().</span><span class="na">name</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; - &quot;</span> <span class="o">+</span> <span class="n">context</span><span class="o">.</span><span class="na">getFileName</span><span class="o">());</span>
      <span class="o">}</span>
      <span class="n">watchKey</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span> <span class="c1">//resetting the key is important to receive subsequent notifications</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>