<div class="highlight"><pre><span class="kn">import</span> <span class="nn">javax.ws.rs.container.AsyncResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.container.Suspended</span><span class="o">;</span>

<span class="nd">@Path</span><span class="o">(</span><span class="s">&quot;/orders&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderResource</span> <span class="o">{</span>
  <span class="nd">@POST</span>
  <span class="nd">@Consumes</span><span class="o">(</span><span class="s">&quot;application/json&quot;</span><span class="o">)</span>
  <span class="nd">@Produces</span><span class="o">(</span><span class="s">&quot;application/json&quot;</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">submit</span><span class="o">(</span><span class="kd">final</span> <span class="n">Order</span> <span class="n">order</span><span class="o">,</span> <span class="kd">final</span> <span class="nd">@Suspended</span> <span class="n">AsyncResponse</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
     <span class="k">new</span> <span class="nf">Thread</span><span class="o">()</span> <span class="o">{</span>
       <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
         <span class="n">OrderConfirmation</span> <span class="n">confirmation</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
         <span class="k">try</span> <span class="o">{</span>
           <span class="n">confirmation</span> <span class="o">=</span> <span class="n">orderProcessor</span><span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
         <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
           <span class="n">response</span><span class="o">.</span><span class="na">resume</span><span class="o">(</span><span class="n">ex</span><span class="o">);</span>
           <span class="k">return</span><span class="o">;</span>
         <span class="o">}</span>
         <span class="n">response</span><span class="o">.</span><span class="na">resume</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
       <span class="o">}</span>
     <span class="o">}.</span><span class="na">start</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>